\lecture{31}{28 Mar. 11:00}{Lebesgue-Radon-Nikodym Theorem}
\begin{lemma}\label{lma:finite-singular}
	Let \(\mu, \nu\) be \hyperref[def:finite-signed-measure]{finite positive measures} on \((X, \mathcal{A})\). Then either
	\begin{itemize}
		\item \(\nu \perp \mu\).
		\item There exists an \(\epsilon > 0\), an \(F \in \mathcal{A}\) such that \(\mu(F) > 0\) and \(F\) is a
		      \hyperref[def:positive-set-for-a-signed-measure]{positive set for the measure} \(\nu - \epsilon \mu\),
		      i.e., for all \(G \subseteq F\), \(\nu(G) \geq \epsilon \mu(G)\).
	\end{itemize}
\end{lemma}

\begin{proof}
	Let \(\kappa_n = \nu - (1/n)\mu\). By \autoref{thm:Hahn-decomposition-theorem} we have \(X = P_n \cup N_n\) for \(P_n\)
	\hyperref[def:positive-set-for-a-signed-measure]{positive}, \(N_n\) \hyperref[def:negative-set-for-a-signed-measure]{negative}
	for \(\kappa _n\). Also, we let \(P = \bigcup_n P_n, N = \bigcap_n N_n = X \setminus P\), then \(X = P \cup N\).

	We see that for any \(n\) we have \(\kappa_n(N) \leq 0\) because \(N \subseteq N_n\). Thus,
	\[
		0 \leq \nu(N) \leq \frac{1}{n}\mu(N),
	\]
	which implies \(\nu(N) = 0\). Because \(\nu\) is \hyperref[def:signed-measure]{positive} for any \(N^\prime  \subseteq N\) we have \(0 \leq \nu(N^\prime ) \leq \nu(N)\),
	and thus \(\nu(N^\prime ) = 0\). This shows \(N\) is \hyperref[def:null-set-for-a-signed-measure]{null} for \(\nu \). Now, we see that
	\begin{itemize}
		\item If \(\mu(P) = 0\), then \(\nu \perp \mu\).
		\item If \(\mu(P) \neq 0\), then we have \(\mu (P) > 0\) hence \(\mu(P_n) > 0\) for some \(n\). With \(F = P_n\) and \(\epsilon = 1/n\), then \(F\) is a
		      \hyperref[def:positive-set-for-a-signed-measure]{positive set} for \(\kappa_n = \nu - (1/n)\mu\) as desired.
	\end{itemize}
\end{proof}

\begin{theorem}[Lebesgue-Radon-Nikodym theorem]\label{thm:Lebesgue-Radon-Nikodym-theorem}
	Let \(\mu\) be a \hyperref[def:finite-signed-measure]{\(\sigma\)-finite positive measure}, \(\nu\) a \hyperref[def:finite-signed-measure]{\(\sigma\)-finite signed measure}
	on \((X, \mathcal{A})\). Then there are unique \hyperref[def:finite-signed-measure]{\(\sigma\)-finite signed measures} \(\lambda,\rho\) on \((X, \mathcal{A})\)
	such that
	\[
		\lambda \perp \mu, \quad \rho \ll \mu, \quad \nu = \lambda + \rho.
	\]
	Furthermore, there exists a \hyperref[def:measurable-function]{measurable function} \(f \colon X \to \overline{\mathbb{R}}\)
	such that \(\,\mathrm{d} \rho = f \,\mathrm{d} \mu\).\footnote{That is for all \(E \in \mathcal{A}\), \(\rho(E) = \int_E f \,\mathrm{d} \mu\).}
	And if there is another \(g\) such that \(\,\mathrm{d} \rho = g \,\mathrm{d} \mu\), then \(f = g\) \hyperref[def:mu-almost-everywhere]{\(\mu\)-a.e.}
\end{theorem}
\begin{proof}
	We prove it step by step.
	\begin{enumerate}[(1)]
		\item Assume \(\mu, \nu\) are \hyperref[def:finite-signed-measure]{finite positive measures}. We first prove the existence of \(\lambda , f\),
		      and \(\,\mathrm{d} \rho = f = \,\mathrm{d} \mu \). Let
		      \[
			      \begin{split}
				      \mathscr{F} & = \left\{g \colon X \to [0,\infty] \mid \int_E g \,\mathrm{d} \mu \leq \nu(E), \forall E \in \mathcal{A}\right\} \\
				      & = \{g \colon X \to [0,\infty] \mid \,\mathrm{d} \nu - g\,\mathrm{d} \mu \text{ is a \hyperref[def:signed-measure]{positive measure}}\}.
			      \end{split}
		      \]
		      This set is nonempty since \(g = 0 \in \mathscr{F}\). Let \(s = \sup\{\int_X g \,\mathrm{d} \mu \mid g \in \mathscr{F}\}\).

		      \begin{claim}
			      There is an \(f \in \mathscr{F}\) such that \(s = \int_X f \,\mathrm{d} \mu\).
		      \end{claim}
		      \begin{explanation}
			      If \(g, h \in \mathscr{F}\), we can define \(u(x) = \max\{g(x),h(x)\}\), then \(u \in \mathscr{F}\). This can be seen by letting
			      \(A = \{x \mid g(x) \geq h(x)\}\), then
			      \[
				      \int_E u \,\mathrm{d} \mu = \int_{E \cap A} g \,\mathrm{d} \mu + \int_{E \cap A^c} h \,\mathrm{d} \mu
				      \leq \nu(E \cap A) + \nu(E \cap A^c) = \nu(E).
			      \]

			      There exist \hyperref[def:measurable-function]{measurable functions} \(g_1,g_2,\ldots \in \mathscr{F}\) such that
			      \[
				      \lim_{n \to \infty} \int_X g_n \,\mathrm{d} \mu = s.
			      \]

			      We can replace \(g_2\) by \(\max(g_1,g_2)\), \(g_3\) by \(\max(g_1,g_2,g_3)\). Generally,
			      \[
				      g_{n} \gets \mathop{\max} (g_1, g_2, \ldots , g_n),
			      \]
			      so that we may assume \(0 \leq g_1 \leq g_2 \leq \ldots\).

			      Then we still know that \(\lim\limits_{n \to \infty} \int_X g_n \,\mathrm{d} \mu = s\), as all the relevant integrals are bounded above by \(s\).
			      Now let \(f(x) = \sup_n g_n(x) = \lim\limits_{n \to \infty} g_n(x)\), by \hyperref[thm:MCT]{monotone convergence theorem},
			      \[
				      \int_E f \,\mathrm{d} \mu = \lim_{n \to \infty} \int_E g_n \,\mathrm{d} \mu \leq \nu(E).
			      \]
			      Thus, \(f \in \mathscr{F}\), and when \(E = X\) we get \(\int_X f \,\mathrm{d} \mu = s\) as desired.
		      \end{explanation}

		      Let \(\rho(E) \coloneqq \int_E f \,\mathrm{d} \mu\), then we of course have \(\rho \ll \mu\), and also, we know
		      \[
			      0 \leq \rho(X) = \int_X f \,\mathrm{d} \mu \leq \nu(X) < \infty.
		      \]
		      Thus, \(\rho\) is a \hyperref[def:finite-signed-measure]{finite positive measure}, so we can define \(\lambda(E) \coloneqq \nu(E) - \rho(E)\), then
		      \[
			      \lambda(E) = \nu(E) - \int_E f \,\mathrm{d} \mu \geq 0
		      \]
		      because \(f \in \mathscr{F}\). Thus, \(\lambda\) is also a \hyperref[def:signed-measure]{positive measure}, and \(\lambda(X) \leq \nu(X) < \infty\).
		      It remains to show the following.

		      \begin{claim}
			      \(\lambda \perp \mu\).
		      \end{claim}
		      \begin{explanation}
			      Suppose not, by \autoref{lma:finite-singular}, there exists \(\epsilon > 0\), \(F \in \mathcal{A}\) such that \(\mu(F) > 0\) and \(F\) is a
			      \hyperref[def:positive-set-for-a-signed-measure]{positive set} for \(\lambda - \epsilon \mu\).

			      Then this says that \(\,\mathrm{d} \lambda - \epsilon \mathbbm{1}_{F} \,\mathrm{d} \mu\) is a \hyperref[def:signed-measure]{positive measure}, that is,
			      \[
				      \,\mathrm{d} \nu - f \,\mathrm{d} \mu - \epsilon \mathbbm{1}_{F} \,\mathrm{d} \mu
			      \]
			      is a \hyperref[def:signed-measure]{positive measure}. But, this will break maximality of \(f\), specifically, let
			      \(g(x) = f(x) + \epsilon \mathbbm{1}_{F} (x)\). Then for all \(E \in \mathcal{A}\) we have
			      \[
				      \begin{split}
					      \int_E g \,\mathrm{d} \mu & = \int_E f \,\mathrm{d} \mu + \epsilon\mu(E \cap F)                 \\
					      &= \nu(E) - \lambda(E) + \epsilon \mu(E \cap F)                      \\
					      &\leq \nu(E) - \lambda(E \cap F) + \epsilon\mu(E \cap F) \leq \nu(E)
				      \end{split}
			      \]
			      since \(\lambda(E \cap F) - \epsilon\mu(E \cap F) \geq 0\). Thus, \(g \in \mathscr{F}\). We then see that
			      \[
				      s \geq \int_X g \,\mathrm{d} \mu  = \int_X f \,\mathrm{d} \mu + \int_X \epsilon \mathbbm{1}_{F} \,\mathrm{d} \mu = s + \epsilon\mu(F) > s,
			      \]
			      which is a contradiction.
		      \end{explanation}
		      We see that the existence of \(\lambda , f\), and \(\,\mathrm{d} \rho = f \,\mathrm{d} \mu \) is proved. As for uniqueness,
		      if there are \(\lambda ^\prime \) and \(f^\prime \) such that \(\,\mathrm{d} \nu = \,\mathrm{d} \lambda ^\prime + f^\prime \,\mathrm{d} \mu \),
		      we then have
		      \[
			      \,\mathrm{d} \lambda - \,\mathrm{d} \lambda ^\prime = (f^\prime -f)\,\mathrm{d} \mu .
		      \]
		      But we see that \(\lambda -\lambda ^\prime \perp \mu \)\todo{Check!} while \((f^\prime -f)\,\mathrm{d} \mu \ll \,\mathrm{d} \mu \), hence
		      \[
			      \,\mathrm{d} \lambda -\,\mathrm{d} \lambda ^\prime = (f^\prime -f)\,\mathrm{d} \mu = 0,
		      \]
		      so \(\lambda = \lambda ^\prime \) and \(f = f^\prime \) \hyperref[def:mu-almost-everywhere]{\(\mu \)-a.e.} by \autoref{prop:lec-13}.
		\item Suppose that \(\mu \) and \(\nu \) are \hyperref[def:finite-signed-measure]{\(\sigma\)-finite measures}. Then \(X\) is a countable disjoint union of
		      \hyperref[def:locally-finite]{\(\mu \)-finite} sets and a countable disjoint union of \(\nu \)-finite sets. By taking intersections of these we obtain
		      a disjoint sequence \(\{A_j\}\subset \mathcal{\MakeUppercase{a}} \) such that \(\mu (A_{j} )\) and \(\nu (A_{j} )\) are finite for all \(j\) and \(X = \bigcup_{j} A_{j} \).
		      Define \(\mu _{j} (E) = \mu (E \cap A_{j} )\) and \(\nu _{j} (E)= \nu (E \cap A_{j} )\), then by the reasoning above, for each \(j\) we have
		      \[
			      \,\mathrm{d} \nu _{j} = \,\mathrm{d} \lambda _{j} + f_{j} \,\mathrm{d} \mu _{j}
		      \]
		      where \(\lambda _{j} \perp \mu _{j} \). Since \(\mu _{j} (A^{c} _{j} ) = \nu _{j} (A^{c} _{j} ) = 0\), we have
		      \[
			      \lambda _{j} (A^{c} _{j} ) = \nu _{j} (A^{c} _{j} )- \int _{A^{c} _{j} }f \,\mathrm{d} \mu _{j} = 0,
		      \]
		      and we may assume that \(f_{j} = 0\) on \(A^{c} _{j} \). Let \(\lambda = \sum_j \lambda _{j} \) and \(f = \sum_{j}f_{j}  \), we then have
		      \[
			      \,\mathrm{d} \nu = \,\mathrm{d} \lambda + f \,\mathrm{d} \mu , \quad \lambda \perp \mu ,
		      \]
		      and \(\,\mathrm{d} \lambda \) and \(f \,\mathrm{d} \mu \) are \hyperref[def:finite-signed-measure]{\(\sigma \)-finite}, as desired. As for uniqueness, it's the same
		      as for the first case.
		\item We now consider the general case. If \(\nu\) is a \hyperref[def:signed-measure]{signed measure}, we apply the preceding argument to \(\nu ^+\) and
		      \(\nu ^-\) and subtract the results.
	\end{enumerate}
\end{proof}
\begin{remark}
	Notationally, we may write \(\,\mathrm{d} \nu = \,\mathrm{d} \lambda + f \,\mathrm{d} \mu\), where \(\,\mathrm{d} \lambda\)
	and \(\,\mathrm{d} \mu\) are \hyperref[def:singular]{singular} to each other.
\end{remark}