\lecture{19}{18 Feb. 11:00}{\hyperref[thm:Fubini-Tonelli-theorem]{Fubini-Tonelli's Theorem}}
\begin{prev}
	If \(E\in A\otimes B\implies E_{x} \in \mathcal{\MakeUppercase{b}} , E^y\in \mathcal{\MakeUppercase{a}}\ \forall x\in X, \forall y\in Y\).
	Note that the reverse is not true.
\end{prev}

\section{Fubini-Tonelli Theorem}
We start with a theorem.

\begin{theorem}[Tonelli's theorem for characteristic functions]\label{thm:Tonelli-for-characteristic-functions}
	Given \((X, \mathcal{\MakeUppercase{a}} , \mu )\) and \((Y, \mathcal{\MakeUppercase{b}} , \nu )\) be \hyperref[def:sigma-finite-measure]{\(\sigma\)-finite}
	\hyperref[def:measure-space]{measure space}. Suppose \(E\in \mathcal{\MakeUppercase{a}} \otimes \mathcal{\MakeUppercase{b}} \), then
	\begin{enumerate}[(1)]
		\item \(\alpha (x)\coloneqq \nu (E_x)\colon X\to [0, \infty ]\) is a \hyperref[def:A-measurable-function]{\(\mathcal{\MakeUppercase{a}}\)-measurable function}.
		\item \(\beta (x)\coloneqq \mu (E^y)\colon Y\to [0, \infty ]\) is a \hyperref[def:A-measurable-function]{\(\mathcal{\MakeUppercase{b}}\)-measurable function}.
		\item \((\mu \times \nu) (E) = \int_X \nu (E_x)\,\mathrm{d} \mu(x) = \int _Y \mu (E^y)\,\mathrm{d} \nu (y)\).
	\end{enumerate}
\end{theorem}
\begin{proof}
	We prove this in two cases.
	\begin{enumerate}
		\item Assume that \(\mu , \nu \) are \hyperref[def:finite-measure]{finite measures}. Let
		      \[
			      C \coloneqq \left\{E\in \mathcal{\MakeUppercase{a}} \otimes \mathcal{\MakeUppercase{b}} \mid \text{ Conditions (1), (2), (3) hold} \right\}.
		      \]
		      It's enough to prove that \(\left< \mathcal{\MakeUppercase{r}}  \right> = \mathcal{\MakeUppercase{a}} \otimes \mathcal{\MakeUppercase{b}} \subset C\).
		      We further observe that from the \autoref{thm:monotone-class-lemma} and the fact that \(\mathcal{\MakeUppercase{r}} \) is an \hyperref[def:algebra]{algebra},
		      it's also enough to show that
		      \begin{itemize}
			      \item \(\mathcal{\MakeUppercase{r}} \subset C\).
			      \item \(C\) is a \hyperref[def:monotone-class]{monotone class}.
		      \end{itemize}
		      \par From condition (1),
		      \[
			      \alpha (x) = \nu \left((A\times B)_x\right) = \begin{dcases}
				      \nu (B), & \text{ if } x\in A ;   \\
				      0,       & \text{ if } x \notin A
			      \end{dcases} = \nu (B)\mathbbm{1}_{A}.
		      \]
		      And from condition (2),
		      \[
			      (\mu \times \nu )(A\times B) = \mu (A)\nu (B)
		      \]
		      and
		      \[
			      \int _X \nu ((A\times B)_x)\,\mathrm{d} \mu (x) = \nu (B)\mu (A).
		      \]

		      \par Let \(E_{n} \in C\), \(E_1\subset E_{2}\subset \ldots\). We need to show \(E = \bigcup\limits_{n=1}^{\infty} E_{n} \in C\).
		      We now see that
		      \[
			      \begin{split}
				      E_{x}  = \bigcup\limits_{n=1}^{\infty} (E_{n} )_x, (E_1)_x\subset (E_2)_x\subset \ldots
				      \implies \alpha (x) = \nu (E_n)_x \overset{\hyperref[thm:measure-space-continuity-from-below]{!}}{=} \lim\limits_{n \to \infty} \nu ((E_n)_x)\ \forall x\in X.
			      \end{split}
		      \]
		      This implies that (1) is proved.

		      For (3), we see that
		      \[
			      \begin{split}
				      (\mu \times \nu )(E)&\overset{\hyperref[thm:measure-space-continuity-from-below]{!}}{=}\lim\limits_{n \to \infty} (\mu \times \nu )(E_{n} )
				      = \lim\limits_{n \to \infty} \int _X \nu ((E_{n})_x) \,\mathrm{d} \mu (x)
				      \overset{\hyperref[thm:MCT]{!}}{=} \int _X \nu (E_{x} )\,\mathrm{d} \mu (x).
			      \end{split}
		      \]

		      \par Now let \(F_{n} \in C\), \(F_1\supset F_2\supset \ldots  \). We need to show that \(F = \bigcap\limits_{n=1}^{\infty} F_{n} \in C\).
		      Instead of using \autoref{thm:MCT}, we now want to use \autoref{thm:dominated-convergence-theorem}, which is applicable since \(\mu (X), \nu (Y)< \infty \)
		      by assumption.
		\item Assume \(\mu\) and \(\nu \) are \hyperref[def:sigma-finite-measure]{\(\sigma \)-finite measures}. We then have a sequence \(\{X_n \times Y_n\}\)
		      of \hyperref[def:rectangle]{rectangles} of with only finite \hyperref[def:measure]{measure}. Now, just consider if \(E\in \mathcal{\MakeUppercase{a}} \otimes \mathcal{\MakeUppercase{b}} \),
		      1. applies to \(E \cap (X_{n} \times Y_{n} )\) for each \(n\), with
		      \[
			      X\times Y = \bigcup\limits_{n=1}^{\infty} (X_{n} \times Y_{n} ), \begin{dcases}
				      X_1\subset X_2\subset \ldots , & \mu (X_{k} )< \infty   \\
				      Y_1\subset Y_2\subset \ldots , & \nu (Y_{k} )< \infty ,
			      \end{dcases}
		      \]
		      we have
		      \[
			      \mu \times \nu (E \cap (X_{n} \times Y_{n} )) = \int \mathbbm{1}_{X_{n} } (x) . \nu (E_{x} \cap Y_{n} )\,\mathrm{d} \nu (x) = \int \mathbbm{1}_{Y_{n} } (y)\mu (E^y \cap X_{n} )\,\mathrm{d} \nu (y).
		      \]
		      By applying \autoref{thm:MCT}, the result follows.
	\end{enumerate}
\end{proof}

\begin{theorem}[Fubini-Tonelli's Theorem]\label{thm:Fubini-Tonelli-theorem}
	Given two \hyperref[def:finite-measure]{\(\sigma \)-finite} \hyperref[def:measure-space]{measure space} \((X, \mathcal{\MakeUppercase{a}} , \mu ), (Y, \mathcal{\MakeUppercase{b}} , \nu )\),
	we have the following.

	\begin{theorem*}[Tonelli's Theorem]\label{thm:Tonelli-theorem}
		If \(f\colon X\times Y\to [0, \infty ]\) is \hyperref[def:A-measurable-function]{\(\mathcal{\MakeUppercase{a}} \otimes \mathcal{\MakeUppercase{b}} \)-measurable},
		then
		\begin{enumerate}[(1)]
			\item \(g(x)\coloneqq \int_Y f(x, y)\,\mathrm{d} \nu (y)\), \(X\to [0, \infty ]\) is a \hyperref[def:A-measurable-function]{\(\mathcal{\MakeUppercase{a}}\)-measurable function}.
			\item \(h(x)\coloneqq \int_X f(x, y)\,\mathrm{d} \mu (x)\), \(Y\to [0, \infty ]\) is a \hyperref[def:A-measurable-function]{\(\mathcal{\MakeUppercase{b}}\)-measurable function}.
			\item We have
			      \[
				      \int_{X\times Y} f \,\mathrm{d}(\mu \times \nu ) = \int _X\left(\int _Y f(x, y)\,\mathrm{d}\nu (y)\right)\mathrm{d} \mu (x) = \int _Y\left(\int_X f(x, y)\,\mathrm{d} \mu (x)\right)\mathrm{d} \nu (y).
			      \]
		\end{enumerate}
	\end{theorem*}

	\begin{theorem*}[Fubini's Theorem]\label{thm:Fubini-theorem}
		If \(f\in L^1(X\times Y, \mu \times \nu )\), then
		\begin{enumerate}[(1)]
			\item \(f_{x} \in L^1(Y, \nu )\) for \hyperref[def:mu-almost-everywhere]{\(\mu\)-a.e.} \(x\), and \(g(x)\in L^1(X, \mu )\) defined \hyperref[def:mu-almost-everywhere]{\(\mu\)-a.e.}
			\item \(f^{y} \in L^1(X, \mu )\) for \hyperref[def:mu-almost-everywhere]{\(\nu\)-a.e.} \(y\), and \(h(x)\in L^1(Y, \nu )\) defined \hyperref[def:mu-almost-everywhere]{\(\mu\)-a.e.}
			\item The iterated integral formulas hold. Namely, we have
			      \[
				      \int_{X\times Y} f \,\mathrm{d}(\mu \times \nu ) = \int _X\left(\int _Y f(x, y)\,\mathrm{d}\nu (y)\right)\mathrm{d} \mu (x) = \int _Y\left(\int_X f(x, y)\,\mathrm{d} \mu (x)\right)\mathrm{d} \nu (y).
			      \]
		\end{enumerate}
	\end{theorem*}
\end{theorem}
\begin{proof}
	Read \cite{folland1999real}.
\end{proof}
\begin{remark}
	The \hyperref[thm:Fubini-theorem]{Fubini} and \hyperref[thm:Tonelli-theorem]{Tonelli's} theorem are frequently used in tandem. Say that if one want to reverse the order of integration in a double integral
	\(\iint f \,\mathrm{d} \mu \,\mathrm{d} \nu \). We first verify that \(\int \left\vert f \right\vert \,\mathrm{d} (\mu \times \nu ) < \infty \) by using
	\hyperref[thm:Tonelli-theorem]{Tonelli's theorem} to evaluate this integral as an iterated integral. Then, we apply \hyperref[thm:Fubini-theorem]{Fubini theorem}
	to conclude that
	\[
		\iint f \,\mathrm{d} \mu \,\mathrm{d} \nu = \iint f \,\mathrm{d} \nu \,\mathrm{d} \mu.
	\]
\end{remark}
