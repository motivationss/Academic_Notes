\lecture{20}{15 Nov. 12:30}{Mixed strategy}
\begin{prev}[Matching pennies revisit]
	Recall the \hyperref[eg:matching-pennies]{matching pennies game}. Assume now that \hyperref[def:player]{player} 2 plays \((\frac{1}{2}, \frac{1}{2})\).
	Now, if \hyperref[def:player]{player} 1 plays
	\begin{itemize}
		\item \((1, 0)\): Utility for \hyperref[def:player]{player} 1 is \(u_1(H, P^{\ast}_2) = \frac{1}{2}\cdot 1 + \frac{1}{2}\cdot -1 = 0\).
		\item \((0, 1)\): Utility for \hyperref[def:player]{player} 1 is \(u_1(T, P^{\ast}_2) = \frac{1}{2}\cdot -1 + \frac{1}{2}\cdot 1 = 0\).
	\end{itemize}
	Hence, the \hyperref[def:reward]{utility} of \hyperref[def:player]{player} 1 is just
	\[
		u_1(P_1, P^{\ast}_2) = P_1(H)u_1(H, P^{\ast}_2)+P_1(T)u_1(T, P^{\ast}_2) = 0.
	\]

	Therefore, any \hyperref[def:mixed-strategy]{mixed strategy} is the \hyperref[def:best-response]{best response}, so we just use
	\((\frac{1}{2}, \frac{1}{2})\) for \hyperref[def:player]{player} 1, and the same is true for \hyperref[def:player]{player} 2. In all, we have
	\[
		P_1^{\ast}\coloneqq \left(\frac{1}{2}, \frac{1}{2}\right), \quad P_2^{\ast}\coloneqq \left(\frac{1}{2}, \frac{1}{2}\right)
	\]
	as the \hyperref[def:Nash-equilibrium]{Nash Equilibrium}.

	\begin{problem}
	What if \hyperref[def:player]{player} 2 was laying \(\left(\frac{2}{3}, \frac{1}{3}\right)\)?
	\end{problem}
	\begin{answer}
		The \hyperref[def:best-response]{best response} for \hyperref[def:player]{player} 1 is to always play \(H\).\todo{Work this out}
	\end{answer}
\end{prev}

\begin{problem}
The \hyperref[def:mixed-strategy]{mixed strategies} are everywhere in real-life. But how can we understand \hyperref[def:mixed-strategy]{mixed strategies}?
\end{problem}
\begin{answer}
	We see that
	\begin{itemize}
		\item \hyperref[def:strategy]{Actions} are distributions or beliefs.
		\item In real life, people do randomize-serving in tennis, bluffing in cards game, openings in chess, etc.
		\item Variations in the population and lack of knowledge of how the other person will play.
	\end{itemize}
\end{answer}

\begin{eg}[Football]\label{eg:football}
	Let \hyperref[def:player]{player} 1 be offense-side, and \hyperref[def:player]{player} 2 be defense-side. They both have two options, one is
	run (or to defense against run), denotes by \(R\), another is pass (or defense against pass), denotes by \(P\).
	\begin{table}[H]
		\centering
		\setlength{\extrarowheight}{2pt}
		\begin{tabular}{cc|c|c|}
			                                               & \multicolumn{1}{c}{} & \multicolumn{2}{c}{\hyperref[def:player]{Player} 2}                           \\
			                                               & \multicolumn{1}{c}{} & \multicolumn{1}{c}{$R$}                             & \multicolumn{1}{c}{$P$} \\\cline{3-4}
			\multirow{2}*{\hyperref[def:player]{Player} 1} & $R$                  & $(0, 0)$                                            & $(5, -5)$               \\\cline{3-4}
			                                               & $P$                  & $(10, -10)$                                         & $(0, 0)$                \\\cline{3-4}
		\end{tabular}
	\end{table}
	we then see that there is a \hyperref[def:Nash-equilibrium]{Nash Equilibrium} such that \hyperref[def:player]{player} 1 plays \((\frac{2}{3}, \frac{1}{3})\), while
	\hyperref[def:player]{player} \(2\) plays \((\frac{1}{3}, \frac{2}{3})\).
\end{eg}

\subsection{Principle of Indifference}
For \hyperref[def:player]{player} \(i\), let \(P_i\in \Delta(\mathcal{S}_{i})\). Now, let the support of \(P_{i}\) to be the \hyperref[def:strategy]{actions} with strictly
positive probability, namely
\[
	\left\{s_{i}\in \mathcal{S}_{i}\colon P_{i}(s_{i})>0\right\}\subseteq \mathcal{S}_{i}.
\]

\begin{eg}
	For example, let \(\left\{a, b, c\right\} = \mathcal{S}_{i}\). Then
	\begin{itemize}
		\item \(P_{i} = (1, 0, 0)\): the support is \(\left\{a\right\}\)
		\item \(P_{i} = (\frac{1}{6}, \frac{5}{6} - \frac{1}{10^6}, \frac{1}{10^6})\): the support is \(\left\{a, b, c\right\}\)
		\item \(P_{i} = (0, \frac{1}{2}, \frac{1}{2})\): the support is \(\left\{b, c\right\}\)
	\end{itemize}
	\begin{note}
		In the second case, we call this a \hyperref[def:fully-mixed]{fully mixed}.
	\end{note}
\end{eg}

\begin{definition}[Fully mixed]\label{def:fully-mixed}
	A \hyperref[def:mixed-strategy]{mixed strategy} is called \emph{fully mixed} if the support of the \hyperref[def:strategy]{strategy} vector is
	on the entire \hyperref[def:strategy]{actions} set.
\end{definition}

\begin{theorem}[Principle of indifference]\label{thm:principle-of-indifference}
	For a \hyperref[def:Nash-equilibrium]{Nash Equilibrium} \(P^{\ast}\), for every \hyperref[def:player]{player} \(i\), if
	\[
		\forall s_{i}^j, s_{i}^k\in \text{support}(P_{i}^{\ast}),
	\]
	we have
	\[
		u_{i}(s_{i}^j, P_{-i}^{\ast}) = u_{i}(s_{i}^k, P_{-i}^{\ast}) = u_{i}(P_{i}^*, P_{-i}^{\ast}).
	\]
\end{theorem}
\begin{proof}
	Let \(s_{i}^j, s_{i}^k\in \mathrm{support}(P_i^{\ast}) \). Then \(P_i^{\ast}(s_{i}^j)>0\) and \(P_i^{\ast}(s_{i}^k)>0\). Now, denotes \(\gamma\) as
	\(\gamma = \min\left(P_i^{\ast}(s_{i}^j), P_i^{\ast}(s_{i}^k)\right)>0\), and let \(\epsilon\coloneqq \left[-\gamma, \gamma\right]\). We can then
	construct a new \hyperref[def:mixed-strategy]{mixed strategy} \(\widetilde{P}_{i}^{\epsilon}\) for \hyperref[def:player]{player} \(i\) as follows.
	For \(s_{i}^j\) and \(s_{i}^k\)
	\[
		\widetilde{P}_{i}^{\epsilon}(s_{i}^j) = P_i^{\ast}(s_{i}^j)- \epsilon,\quad\widetilde{P}_{i}^{\epsilon}(s_{i}^k) = P_i^{\ast}(s_{i}^k)+\epsilon,
	\]
	with \(\widetilde{P}_{i}^{\epsilon}(s_{i}) = P_i^{\ast}(s_{i})\) for all \(s_{i}\in \mathcal{S}_{i}\setminus\left\{s_{i}^j, s_{i}^k\right\}\),
	which means that the other \hyperref[def:strategy]{actions} remain the same. Since \(P^{\ast}\) is a \hyperref[def:Nash-equilibrium]{Nash Equilibrium}, so we have
	\[
		u_{i}\left(P^{\ast}_i, P_{i}^{\ast}\right) = \max_{P_{i}\in \Delta(\mathcal{S}_{i})} u_{i}(P_{i}, P_{-i}^{\ast}) \geq u_{i}(\widetilde{P}_{i}^{\epsilon}, P_{-i}^{\ast}).
	\]
	Furthermore, the left-hand side is
	\[
		\begin{split}
			u_{i}\left(P^{\ast}_i, P_{-i}^{\ast}\right) = P_{i}^{\ast}(s_{i}^j)u_{i}(s_{i}^j, P^{\ast}_{-i}) + P^{\ast}_{i}(s_{i}^{k})u_{i}(s_{i}^{k}, P^{\ast}_{-i})
			+ \sum\limits_{ s_{i}\in \mathcal{S}_{i}\setminus\left\{s_{i}^j, s_{i}^*\right\}} P^{\ast}_{i}(s_{i})u_{i}(s_{i}, P^{\ast}_{-i}),
		\end{split}
	\]
	and the right-hand side is
	\[
		\begin{split}
			u_{i}\left(\widetilde{P}^{\epsilon}_i, P_{-i}^{\ast}\right) = \widetilde{P}_{i}^{\epsilon}(s_{i}^j)u_{i}(s_{i}^j, P^{\ast}_{-i}) + \widetilde{P}^{\epsilon}_{i}(s_{i}^{k})u_{i}(s_{i}^{k}, P^{\ast}_{-i})
			+ \sum\limits_{ s_{i}\in \mathcal{S}_{i}\setminus\left\{s_{i}^j, s_{i}^*\right\}} P^{\ast}_{i}(s_{i})u_{i}(s_{i}, P^{\ast}_{-i}).
		\end{split}
	\]

	Then we see that the inequality is
	\[
		P_{i}^{\ast}(s_{i}^j)u_{i}(s_{i}^j, P_{-i}^{\ast})+ P_{i}^{\ast}(s_{i}^k)u_{i}(s_{i}^k, P_{-i}^{\ast})\geq \widetilde{P}_{i}^{\epsilon}(s_{i}^j)u_{i}(s_{i}^j, P^{\ast}_{-i})+\widetilde{P}_{i}^{\epsilon}(s_{i}^k)u_{i}(s_{i}^k, P^{\ast}_{-i})
	\]
	since the summation part is the same. Rearranging, we have
	\[
		\epsilon u_{i}(s_{i}^j, P^{\ast}_{-i})\geq \epsilon u_{i}(s_{i}^k, P^{\ast}_{-i}).
	\]
	Since \(\epsilon\in\left[-\gamma, \gamma\right]\), we further have
	\[
		u_{i}(s_{i}^j, P^{\ast}_{-i}) = u_{i}(s_{i}^k, P^{\ast}_{-i}) = u.
	\]
	Hence,
	\[
		u_{i}(P^{\ast}_{i}, P^{\ast}_{i}) = \sum\limits_{s_{i}\in \mathrm{\text{support}(P^{\ast}_{i})} }P^{\ast}_{i}(s_{i})\underbrace{u_{i}(s_{i}, P^{\ast}_{-i})}_{u} = u.
	\]
	The last equality follows since
	\[
		\sum\limits_{s_{i}\in \mathrm{support}(P^{\ast}_i) } P_{i}^{\ast}(s_{i}) = 1.
	\]
\end{proof}

\begin{intuition}
	In other words, given the \hyperref[def:strategy]{strategies} of the opponents, \hyperref[def:player]{player} \(i\) is \textbf{indifferent} between the
	\hyperref[def:strategy]{strategies} in the \(\mathrm{support}(P_{i}^{\ast}) \) because they yield the same \hyperref[def:reward]{payoff}.
\end{intuition}

Now, we show a general method to find all \hyperref[def:Nash-equilibrium]{Nash Equilibrium} in a \(2\) \hyperref[def:player]{players} and \(2\) \hyperref[def:strategy]{actions}
\hyperref[def:game]{game}. Let the \hyperref[def:payoff-matrix]{payoff matrix} be like
\begin{table}[H]
	\centering
	\setlength{\extrarowheight}{2pt}
	\begin{tabular}{cc|c|c|}
		                                               & \multicolumn{1}{c}{} & \multicolumn{2}{c}{\hyperref[def:player]{Player} 2}                           \\
		                                               & \multicolumn{1}{c}{} & \multicolumn{1}{c}{$L$}                             & \multicolumn{1}{c}{$R$} \\\cline{3-4}
		\multirow{2}*{\hyperref[def:player]{Player} 1} & $U$                  & $(a_{U, L}, b_{U, L})$                              & $(a_{U, R}, b_{U, R})$  \\\cline{3-4}
		                                               & $D$                  & $(a_{D, L}, b_{D, L})$                              & $(a_{D, R}, b_{D, R})$  \\\cline{3-4}
	\end{tabular}
\end{table}
Let
\begin{itemize}
	\item \hyperref[def:player]{Player} 1 plays \hyperref[def:strategy]{strategy} \((p, 1 - p)\) with \(p\in \left[0, 1\right]\).
	\item \hyperref[def:player]{Player} 1 plays \hyperref[def:strategy]{strategy} \((q, 1 - q)\) with \(q\in \left[0, 1\right]\).
\end{itemize}
We then find all the \hyperref[def:best-response]{best response} of each \hyperref[def:player]{player} in a parametric form.
Says \hyperref[def:player]{player} 1 with \(p^{\ast}(q)\), while \hyperref[def:player]{player} 2 with \(q^{\ast}(p)\), where they can be a set. We see that
\[
	p^{\ast}(q) = \arg\max_{\widetilde{p}\in\left[0, 1\right]}u_1\left((\widetilde{p}, 1 - \widetilde{p}), (q, 1 - q)\right).
\]
Then
\[
	\begin{split}
		&u_1\left((\widetilde{p}, 1 - \widetilde{p}), (q, 1 - q)\right) \\
		= &\widetilde{p}\left(q\cdot a_{U, L} + (1 - q)a_{U, R}\right)+(1 - \widetilde{p})\left(q\cdot a_{D, L}+(1 - q)a_{D, R}\right)\\
		= &\widetilde{p}\left(\left[q\cdot a_{U, L}+(1 - q)a_{U, R}\right] - \left[q\cdot a_{D, L} + (1 - q)a_{D, R}\right]\right)+\left(q\cdot a_{D, L}+(1 - q)a_{D, R}\right)
	\end{split}
\]

Now, denotes \(C\) as
\[
	C\coloneqq \left[q\cdot a_{U, L}+(1 - q)a_{U, R}\right] - \left[q\cdot a_{D, L} + (1 - q)a_{D, R}\right],
\]
there are three cases for \(C\):
\begin{figure}[H]
	\centering
	\incfig{utility-c}
	\label{fig:utility-c}
\end{figure}
We see that
\begin{itemize}
	\item \(C>0\): maximizes in \(\widetilde{p} = 1\)
	\item \(C<0\): maximizes in \(\widetilde{p} = 0\)
	\item \(C=0\): maximizes in \(\widetilde{p} = [0, 1]\)
\end{itemize}

Then we denote
\[
	\arg\max_{\widetilde{p}\in[0, 1]}u_1\left((\widetilde{p}, 1 - \widetilde{p}), (q, 1 - q)\right) \eqqcolon p^{\ast}\coloneqq
	\begin{dcases}
		1,      & \text{if } C > 0;                       \\
		0,      & \text{if } C < 0;                       \\
		[0, 1], & \text{if } C = 0 (\text{Indifference}).
	\end{dcases}
\]

Use the similar calculations to find \(q^{\ast}(p)\) using the \hyperref[def:best-response]{best response}. We conclude that
\[
	(\overline{p}, \overline{q}) \text{ is a Nash Equilibrium} \iff \overline{p}\in p^{\ast}(\overline{q}) \land \overline{q}\in q^{\ast}(\overline{p}),
\]
namely they are the \hyperref[def:best-response]{best response} of each other.
\begin{figure}[H]
	\centering
	\incfig{NE-intersection}
	\label{fig:NE-intersection}
\end{figure}

\begin{eg}[Matching pennies revisit]
	Coming back to the \hyperref[eg:matching-pennies]{matching pennies} games. We have
	\[
		p^{\ast}(q) = \begin{dcases}
			1,      & \text{if } q > \frac{1}{2} \\
			[0, 1], & \text{if } q = \frac{1}{2} \\
			0,      & \text{if } q < \frac{1}{2}
		\end{dcases}, \quad q^{\ast}(p) = \begin{dcases}
			1,      & \text{if } p > \frac{1}{2}  \\
			[0, 1], & \text{if } p = \frac{1}{2}  \\
			0,      & \text{if } p < \frac{1}{2}.
		\end{dcases}
	\]
	After plotting, we see that \((\frac{1}{2}, \frac{1}{2})\) is the only intersection, so it's the only \hyperref[def:Nash-equilibrium]{Nash equilibrium}.
	\begin{figure}[H]
		\centering
		\incfig{NE-matching-pennies}
		\label{fig:NE-matching-pennies}
	\end{figure}
\end{eg}

\begin{eg}[Football revisit]
	We also look at the \hyperref[eg:football]{football game} example. We see that for \(p^{\ast}(q)\), we have
	\begin{itemize}
		\item \(R\): \hyperref[def:reward]{utility} is \(q(0)+(1 - q)5 = 5 - 5q\).
		\item \(P\): \hyperref[def:reward]{utility} is \(q(10)+(1 - q)0 = 10q\).
	\end{itemize}
	Hence, the difference is \(5 - 5q-10q  = 5 - 15q\), so
	\[
		5 - 15q \implies \begin{dcases}
			\text{Difference }> 0, p^{\ast}(q) = 1,     & 5>15q \implies q<\frac{1}{3}; \\
			\text{Difference }< 0, p^{\ast}(q) = 0,     & 5<15q \implies q>\frac{1}{3}; \\
			\text{Difference }= 0, p^{\ast}(q) = [0,1], & 5=15q \implies q=\frac{1}{3}.
		\end{dcases}
	\]

	As for \(q^{\ast}(p)\), we have
	\begin{itemize}
		\item \(R\): \hyperref[def:reward]{utility} is \(p(0)+(1 - p)(-10)= -10 + 10p\).
		\item \(P\): \hyperref[def:reward]{utility} is \(p(-5)+(1 - p)0 = -5q\).
	\end{itemize}
	Hence, the difference is \(-10 + 10p - (-5p) = -10 + 15p\), so
	\[
		-10 +15p\implies \begin{dcases}
			\text{Difference }> 0, q^{\ast}(p) = 1,     & 5>15q \implies p>\frac{2}{3}; \\
			\text{Difference }< 0, q^{\ast}(p) = 0,     & 5<15q \implies p<\frac{2}{3}; \\
			\text{Difference }= 0, q^{\ast}(p) = [0,1], & 5=15q \implies p=\frac{2}{3}.
		\end{dcases}
	\]
	\begin{figure}[H]
		\centering
		\incfig{NE-football}
		\label{fig:NE-football}
	\end{figure}
\end{eg}

\begin{eg}[Market entering]\label{eg:market-entering}
	We now look at a new \hyperref[def:game]{game}. Consider the Market entering \hyperref[def:game]{game}. Let the \hyperref[def:payoff-matrix]{payoff matrix} being
	\begin{table}[H]
		\centering
		\setlength{\extrarowheight}{2pt}
		\begin{tabular}{cc|c|c|}
			                                               & \multicolumn{1}{c}{} & \multicolumn{2}{c}{\hyperref[def:player]{Player} 2}                           \\
			                                               & \multicolumn{1}{c}{} & \multicolumn{1}{c}{$E$}                             & \multicolumn{1}{c}{$D$} \\\cline{3-4}
			\multirow{2}*{\hyperref[def:player]{Player} 1} & $E$                  & $(-1, -1)$                                          & $(3, 0)$                \\\cline{3-4}
			                                               & $D$                  & $(0, 3)$                                            & $(0, 0)$                \\\cline{3-4}
		\end{tabular}
	\end{table}
	We immediately see that \((E, D)\) and \((D, E)\) are \hyperref[def:pure-strategy]{pure} \hyperref[def:Nash-equilibrium]{Nash equilibrium}. And since we always
	have odd number of \hyperref[def:Nash-equilibrium]{Nash equilibrium}, hence there are one more \hyperref[def:mixed-strategy]{mixed strategy}
	\hyperref[def:Nash-equilibrium]{Nash equilibrium}. By using the \hyperref[thm:principle-of-indifference]{principle of indifference}, we see that
	\[
		\begin{dcases}
			u_1(E, \overline{q}) & = \overline{q}( - 1)+(1-\overline{q})3 = 3 - 4 \overline{q} \\
			u_1(D, \overline{q}) & = \overline{q}(0)+(1 - \overline{q})0 = 0,
		\end{dcases}
	\]
	so we have
	\[
		u_1(E, \overline{q}) = u_1(D, \overline{q})
	\]
	by the \hyperref[thm:principle-of-indifference]{principle of indifference}. This implies \(\overline{p} = \frac{3}{4}\).
	\begin{figure}[H]
		\centering
		\incfig{NE-market-entering}
		\caption{There are \(3\) \hyperref[def:Nash-equilibrium]{NE}.}
		\label{fig:NE-market-entering}
	\end{figure}
\end{eg}